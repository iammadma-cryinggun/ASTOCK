//@version=5
indicator("è‚¡ç¥¨ç‹™å‡»æ‰‹ - å®Œæ•´æŠ€æœ¯åˆ†æ", overlay=true, max_boxes_count=500, max_lines_count=500)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Š è‚¡ç¥¨ç‹™å‡»æ‰‹ - TradingView å®Œæ•´æŠ€æœ¯æŒ‡æ ‡
//
// åŠŸèƒ½ï¼š
// 1. è‡ªåŠ¨è¶‹åŠ¿çº¿é€šé“ï¼ˆåŸºäº ZigZag æå€¼ç‚¹ï¼‰
// 2. å¤šç©ºæ’åˆ—åˆ¤æ–­ï¼ˆMA5/10/20/60ï¼‰
// 3. MACD + KDJ åŒå…±æŒ¯
// 4. ç‹™å‡»ç‚¹ä½æ ‡æ³¨ï¼ˆç†æƒ³ä¹°ç‚¹/å–ç‚¹ï¼‰
// 5. æ“ä½œæ£€æŸ¥æ¸…å•ï¼ˆå¯è§†åŒ–é¢æ¿ï¼‰
// 6. æç«¯é£é™©è­¦æŠ¥
// 7. åç«¯ API é›†æˆï¼ˆå¯é€‰ï¼‰
//
// ä½¿ç”¨è¯´æ˜ï¼š
// - å°†æ­¤ä»£ç å¤åˆ¶åˆ° TradingView Pine Editor
// - ç‚¹å‡»"æ·»åŠ åˆ°å›¾è¡¨"
// - ç†æƒ³ä¹°ç‚¹ä¼šç”¨â˜…æ ‡æ³¨ï¼Œç†æƒ³å–ç‚¹ç”¨â˜†æ ‡æ³¨
//
// åç«¯é›†æˆï¼ˆå¯é€‰ï¼‰ï¼š
// - åœ¨å›¾è¡¨å³é”®ç‚¹å‡» -> æ·»åŠ æé†’
// - æ¡ä»¶ï¼šç‹™å‡»ç‚¹ä½ä¿¡å·
// - Webhook URL: https://your-server.com/api/analysis
// - æ¶ˆæ¯: {"code": "{{ticker}}", "signal": "{{plot_0}}", "price": {{close}}}
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”§ å‚æ•°è®¾ç½®
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// è¶‹åŠ¿çº¿å‚æ•°
zigZagDeviation = input.int(5, "ZigZag åç¦»%", minval=1, maxval=20, group="è¶‹åŠ¿çº¿")
zigZagLookback = input.int(20, "ZigZag å›çœ‹å‘¨æœŸ", minval=5, maxval=50, group="è¶‹åŠ¿çº¿")

// å‡çº¿å‚æ•°
maFast = input.int(5, "å¿«é€Ÿå‡çº¿", minval=1, group="å‡çº¿ç³»ç»Ÿ")
maMid = input.int(10, "ä¸­çº¿å‡çº¿", minval=1, group="å‡çº¿ç³»ç»Ÿ")
maSlow = input.int(20, "æ…¢é€Ÿå‡çº¿", minval=1, group="å‡çº¿ç³»ç»Ÿ")
maVerySlow = input.int(60, "è¶…æ…¢å‡çº¿", minval=1, group="å‡çº¿ç³»ç»Ÿ")

// MACD å‚æ•°
macdFast = input.int(12, "MACD å¿«çº¿", minval=1, group="MACD")
macdSlow = input.int(26, "MACD æ…¢çº¿", minval=1, group="MACD")
macdSignal = input.int(9, "MACD ä¿¡å·çº¿", minval=1, group="MACD")

// KDJ å‚æ•°
kdjPeriod = input.int(14, "KDJ å‘¨æœŸ", minval=1, group="KDJ")

// ç‹™å‡»ç‚¹ä½å‚æ•°
idealBuyDeviation = input.float(2.0, "ç†æƒ³ä¹°ç‚¹ä¹–ç¦»ç‡%", minval=0.5, maxval=5.0, step=0.1, group="ç‹™å‡»ç‚¹ä½")
idealSellDeviation = input.float(5.0, "ç†æƒ³å–ç‚¹ä¹–ç¦»ç‡%", minval=2.0, maxval=10.0, step=0.1, group="ç‹™å‡»ç‚¹ä½")

// é¢œè‰²è®¾ç½®
colorBullish = input.color(color.new(color.green, 0), "å¤šå¤´é¢œè‰²", group="é¢œè‰²è®¾ç½®")
colorBearish = input.color(color.new(color.red, 0), "ç©ºå¤´é¢œè‰²", group="é¢œè‰²è®¾ç½®")
colorNeutral = input.color(color.new(color.gray, 0), "ä¸­æ€§é¢œè‰²", group="é¢œè‰²è®¾ç½®")

// å¼€å¯/å…³é—­åŠŸèƒ½
showTrendLines = input.bool(true, "æ˜¾ç¤ºè¶‹åŠ¿çº¿", group="æ˜¾ç¤ºé€‰é¡¹")
showSniperPoints = input.bool(true, "æ˜¾ç¤ºç‹™å‡»ç‚¹ä½", group="æ˜¾ç¤ºé€‰é¡¹")
showChecklist = input.bool(true, "æ˜¾ç¤ºæ£€æŸ¥æ¸…å•", group="æ˜¾ç¤ºé€‰é¡¹")
showRiskAlert = input.bool(true, "æ˜¾ç¤ºé£é™©è­¦æŠ¥", group="æ˜¾ç¤ºé€‰é¡¹")

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“ˆ æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 1. å‡çº¿ç³»ç»Ÿ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ma5 = ta.sma(close, maFast)
ma10 = ta.sma(close, maMid)
ma20 = ta.sma(close, maSlow)
ma60 = ta.sma(close, maVerySlow)

// ç»˜åˆ¶å‡çº¿
plot(ma5, "MA5", color=color.yellow, linewidth=1)
plot(ma10, "MA10", color=color.orange, linewidth=1)
plot(ma20, "MA20", color=color.blue, linewidth=2)
plot(ma60, "MA60", color=color.purple, linewidth=2)

// å¤šç©ºæ’åˆ—åˆ¤æ–­
bullishArrangement = ma5 > ma10 and ma10 > ma20 and ma20 > ma60
bearishArrangement = ma5 < ma10 and ma10 < ma20 and ma20 < ma60

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 2. MACD æŒ‡æ ‡
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[macdLine, signalLine, histLine] = ta.macd(close, macdFast, macdSlow, macdSignal)
macdBullish = macdLine > signalLine
macdGoldenCross = ta.crossover(macdLine, signalLine)
macdDeathCross = ta.crossunder(macdLine, signalLine)

// MACD å¤šå¤´å¼ºåº¦
macdStrength = (macdLine - signalLine) / ta.atr(14) * 100

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 3. KDJ æŒ‡æ ‡
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// KDJ è®¡ç®—ï¼ˆæœªæˆç†Ÿéšæœºå€¼ RSVï¼‰
lowestLow = ta.lowest(low, kdjPeriod)
highestHigh = ta.highest(high, kdjPeriod)
rsv = (close - lowestLow) / (highestHigh - lowestLow) * 100

kValue = ta.sma(rsv, 3)
dValue = ta.sma(kValue, 3)
jValue = 3 * kValue - 2 * dValue

kdjBullish = kValue > dValue and kValue > 20 and kValue < 80
kdjOverbought = kValue > 80
kdjOversold = kValue < 20

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 4. åŒå…±æŒ¯ä¿¡å·
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
doubleBullish = macdBullish and kdjBullish
doubleBearish = not macdBullish and not kdjBullish

// é‡‘å‰å…±æŒ¯
goldenCrossResonance = macdGoldenCross and kdjOversold

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 5. ä¹–ç¦»ç‡ï¼ˆBiasï¼‰
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bias = (close - ma20) / ma20 * 100

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 6. å¸ƒæ—å¸¦
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[bbMiddle, bbUpper, bbLower] = ta.bb(close, 20, 2)
bbWidth = (bbUpper - bbLower) / bbMiddle * 100

// å¸ƒæ—å¸¦ squeezeï¼ˆæ”¶ç¼©ï¼‰
bbSqueeze = bbWidth < ta.sma(bbWidth, 50) * 0.8

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¯ ç‹™å‡»ç‚¹ä½åˆ¤æ–­
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// ç†æƒ³ä¹°ç‚¹æ¡ä»¶
idealBuyCondition = bullishArrangement and doubleBullish and bias < idealBuyDeviation and bias > -idealBuyDeviation

// ç†æƒ³å–ç‚¹æ¡ä»¶
idealSellCondition = bearishArrangement and doubleBearish and bias > idealSellDeviation

// è¶‹åŠ¿åè½¬ä¿¡å·
trendReversalBuy = bearishArrangement[1] and bullishArrangement and goldenCrossResonance
trendReversalSell = bullishArrangement[1] and bearishArrangement and kdjOverbought

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// æ ‡æ³¨ç‹™å‡»ç‚¹ä½
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if showSniperPoints
    // ç†æƒ³ä¹°ç‚¹
    if idealBuyCondition
        label.new(bar_index, low, "â˜…ç†æƒ³ä¹°ç‚¹\n" + str.tostring(close, "#.##"),
                  color=color.new(color.green, 0),
                  textcolor=color.white,
                  style=label.style_label_up,
                  size=size.large)

    // ç†æƒ³å–ç‚¹
    if idealSellCondition
        label.new(bar_index, high, "â˜†ç†æƒ³å–ç‚¹\n" + str.tostring(close, "#.##"),
                  color=color.new(color.red, 0),
                  textcolor=color.white,
                  style=label.style_label_down,
                  size=size.large)

    // è¶‹åŠ¿åè½¬ä¹°ç‚¹
    if trendReversalBuy
        label.new(bar_index, low, "ğŸ”„åè½¬ä¹°ç‚¹\n" + str.tostring(close, "#.##"),
                  color=color.new(color.blue, 0),
                  textcolor=color.white,
                  style=label.style_label_up,
                  size=size.normal)

    // è¶‹åŠ¿åè½¬å–ç‚¹
    if trendReversalSell
        label.new(bar_index, high, "ğŸ”„åè½¬å–ç‚¹\n" + str.tostring(close, "#.##"),
                  color=color.new(color.orange, 0),
                  textcolor=color.white,
                  style=label.style_label_down,
                  size=size.normal)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“‹ æ“ä½œæ£€æŸ¥æ¸…å•ï¼ˆå¯è§†åŒ–é¢æ¿ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if showChecklist and barstate.islast
    // åˆ›å»ºæ£€æŸ¥æ¸…å•è¡¨æ ¼
    var table checklistTable = table.new(position.top_right, 2, 10,
                                         bgcolor=color.new(color.white, 5),
                                         border_width=1,
                                         border_color=color.gray)

    // æ ‡é¢˜
    table.cell(checklistTable, 0, 0, "æ“ä½œæ£€æŸ¥æ¸…å•",
               bgcolor=color.new(color.blue, 20),
               text_color=color.white,
               text_size=size.normal,
               width=200)

    // å¡«å……æ£€æŸ¥æ¸…å•
    // 1. å¤šå¤´æ’åˆ—
    table.cell(checklistTable, 0, 1, "å¤šå¤´æ’åˆ—",
               text_color=color.black, text_size=size.small)
    table.cell(checklistTable, 1, 1,
               bullishArrangement ? "âœ… æ˜¯" : "âŒ å¦",
               text_color=bullishArrangement ? color.green : color.red,
               text_size=size.small)

    // 2. MACD å¤šå¤´
    table.cell(checklistTable, 0, 2, "MACD å¤šå¤´",
               text_color=color.black, text_size=size.small)
    table.cell(checklistTable, 1, 2,
               macdBullish ? "âœ… æ˜¯" : "âŒ å¦",
               text_color=macdBullish ? color.green : color.red,
               text_size=size.small)

    // 3. KDJ å¤šå¤´
    table.cell(checklistTable, 0, 3, "KDJ å¤šå¤´",
               text_color=color.black, text_size=size.small)
    table.cell(checklistTable, 1, 3,
               kdjBullish ? "âœ… æ˜¯" : "âŒ å¦",
               text_color=kdjBullish ? color.green : color.red,
               text_size=size.small)

    // 4. åŒå…±æŒ¯
    table.cell(checklistTable, 0, 4, "MACD+KDJ åŒå…±æŒ¯",
               text_color=color.black, text_size=size.small)
    table.cell(checklistTable, 1, 4,
               doubleBullish ? "âœ… æ˜¯" : "âŒ å¦",
               text_color=doubleBullish ? color.green : color.red,
               text_size=size.small)

    // 5. ä¹–ç¦»ç‡
    table.cell(checklistTable, 0, 5, "ä¹–ç¦»ç‡",
               text_color=color.black, text_size=size.small)
    biasText = str.tostring(bias, "#.##") + "%"
    biasColor = bias > idealSellDeviation ? color.red : bias < -idealBuyDeviation ? color.green : color.yellow
    table.cell(checklistTable, 1, 5, biasText,
               text_color=biasColor,
               text_size=size.small)

    // 6. å¸ƒæ—å¸¦ä½ç½®
    bbPosition = (close - bbLower) / (bbUpper - bbLower) * 100
    table.cell(checklistTable, 0, 6, "å¸ƒæ—å¸¦ä½ç½®",
               text_color=color.black, text_size=size.small)
    bbColor = bbPosition > 80 ? color.red : bbPosition < 20 ? color.green : color.yellow
    table.cell(checklistTable, 1, 6,
               str.tostring(bbPosition, "#.#") + "%",
               text_color=bbColor,
               text_size=size.small)

    // 7. å½“å‰è¶‹åŠ¿
    table.cell(checklistTable, 0, 7, "å½“å‰è¶‹åŠ¿",
               text_color=color.black, text_size=size.small)
    trendText = bullishArrangement ? "ğŸ“ˆ å¤šå¤´" : bearishArrangement ? "ğŸ“‰ ç©ºå¤´" : "â¡ï¸ éœ‡è¡"
    trendColor = bullishArrangement ? color.green : bearishArrangement ? color.red : color.gray
    table.cell(checklistTable, 1, 7, trendText,
               text_color=trendColor, text_size=size.small)

    // 8. æ“ä½œå»ºè®®
    table.cell(checklistTable, 0, 8, "æ“ä½œå»ºè®®",
               text_color=color.black, text_size=size.small)
    adviceText = idealBuyCondition ? "ğŸŸ¢ ä¹°å…¥" : idealSellCondition ? "ğŸ”´ å–å‡º" : bullishArrangement ? "ğŸŸ¡ æŒæœ‰" : "âšªï¸ è§‚æœ›"
    table.cell(checklistTable, 1, 8, adviceText, text_size=size.small)

    // 9. ä¿¡å·å¼ºåº¦
    signalStrength = 0
    if bullishArrangement
        signalStrength += 1
    if macdBullish
        signalStrength += 1
    if kdjBullish
        signalStrength += 1
    if doubleBullish
        signalStrength += 2

    table.cell(checklistTable, 0, 9, "ä¿¡å·å¼ºåº¦",
               text_color=color.black, text_size=size.small)
    strengthText = str.tostring(signalStrength) + "/5"
    strengthColor = signalStrength >= 4 ? color.green : signalStrength >= 3 ? color.yellow : signalStrength >= 2 ? color.orange : color.red
    table.cell(checklistTable, 1, 9, strengthText,
               text_color=strengthColor, text_size=size.small)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš ï¸ é£é™©è­¦æŠ¥
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if showRiskAlert
    // æç«¯ä¹–ç¦»ç‡è­¦æŠ¥
    extremeBias = bias > 8 or bias < -8

    if extremeBias
        bgcolor(color.new(color.red, 90))

    // å¸ƒæ—å¸¦çªç ´è­¦æŠ¥
    bbBreakout = close > bbUpper or close < bbLower

    if bbBreakout
        bgcolor(color.new(color.orange, 90))

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“¡ ä¿¡å·è¾“å‡ºï¼ˆç”¨äº Alert é›†æˆåç«¯ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// å®šä¹‰ä¿¡å·ç±»å‹
signal = idealBuyCondition ? "IDEAL_BUY" :
         idealSellCondition ? "IDEAL_SELL" :
         trendReversalBuy ? "REVERSAL_BUY" :
         trendReversalSell ? "REVERSAL_SELL" : "NONE"

// ç»˜åˆ¶ä¿¡å·ï¼ˆç”¨äºåˆ›å»º Alertï¼‰
plotchar(signal != "NONE", "ç‹™å‡»ä¿¡å·", "â€¢", location.top, size=size.tiny)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Š è¶‹åŠ¿çº¿é€šé“ï¼ˆå¯é€‰ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if showTrendLines
    // æŸ¥æ‰¾æå€¼ç‚¹
    var float highLevel = na
    var float lowLevel = na
    var int highBar = na
    var int lowBar = na

    // æ£€æµ‹æ–°çš„é«˜ç‚¹
    if high == ta.highest(high, zigZagLookback) and high > ta.highest(high[1], zigZagLookback) * (1 + zigZagDeviation / 100)
        highLevel := high
        highBar := bar_index

    // æ£€æµ‹æ–°çš„ä½ç‚¹
    if low == ta.lowest(low, zigZagLookback) and low < ta.lowest(low[1], zigZagLookback) * (1 - zigZagDeviation / 100)
        lowLevel := low
        lowBar := bar_index

    // ç»˜åˆ¶è¶‹åŠ¿çº¿
    if not na(highLevel) and not na(lowLevel)
        if highBar > lowBar
            line.new(lowBar, lowLevel, highBar, highLevel,
                    color=color.new(color.blue, 0),
                    width=2,
                    style=line.style_solid,
                    extend=extend.right)
        else
            line.new(highBar, highLevel, lowBar, lowLevel,
                    color=color.new(color.red, 0),
                    width=2,
                    style=line.style_solid,
                    extend=extend.right)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“ ä¿¡æ¯æç¤º
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// åº•éƒ¨ä¿¡æ¯æ 
var table infoTable = table.new(position.bottom_right, 2, 3,
                                bgcolor=color.new(color.white, 5),
                                border_width=1,
                                border_color=color.gray)

if barstate.islast
    table.cell(infoTable, 0, 0, "è‚¡ç¥¨ä»£ç ",
               bgcolor=color.new(color.blue, 20),
               text_color=color.white,
               text_size=size.small)
    table.cell(infoTable, 1, 0, syminfo.ticker,
               text_size=size.small)

    table.cell(infoTable, 0, 1, "å½“å‰ä»·æ ¼",
               text_color=color.black,
               text_size=size.small)
    table.cell(infoTable, 1, 1, str.tostring(close, "#.##"),
               text_color=color.black,
               text_size=size.small)

    table.cell(infoTable, 0, 2, "ä¿¡å·çŠ¶æ€",
               text_color=color.black,
               text_size=size.small)
    signalText = signal == "IDEAL_BUY" ? "ğŸŸ¢ ç†æƒ³ä¹°ç‚¹" :
                 signal == "IDEAL_SELL" ? "ğŸ”´ ç†æƒ³å–ç‚¹" :
                 signal == "REVERSAL_BUY" ? "ğŸ”„ åè½¬ä¹°ç‚¹" :
                 signal == "REVERSAL_SELL" ? "ğŸ”„ åè½¬å–ç‚¹" : "âšª æ— ä¿¡å·"
    table.cell(infoTable, 1, 2, signalText,
               text_size=size.small)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸš€ Alert æç¤ºæ¶ˆæ¯
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// åˆ›å»º Alert æ—¶ä½¿ç”¨ä»¥ä¸‹æ¶ˆæ¯æ ¼å¼ï¼š
// {
//   "code": "{{ticker}}",
//   "signal": "{{plot_0}}",
//   "price": {{close}},
//   "time": "{{time}}",
//   "ma5": {{plot_1}},
//   "ma20": {{plot_3}}
// }
//
// Webhook URL: https://your-server.com/api/analysis
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
