# 报告类型对比说明

## 核心要点

**精简报告和完整报告使用完全相同的分析逻辑！**

区别仅在于：
- ✅ **相同的数据来源**（技术面、基本面、消息面）
- ✅ **相同的 AI 分析过程**（temperature=0.0，确保一致性）
- ✅ **相同的分析结果**（sentiment_score、operation_advice 等完全一样）
- ⚠️ **不同的显示内容**（完整报告显示更多字段）

---

## WebUI 显示差异

### 📝 精简报告（5个字段）

点击任务卡片展开后显示：

```
📌 中国中免(601888) - 短期震荡调整，中长期仍具备配置价值

📊 趋势: 震荡
🎯 建议: 观望
📈 置信度: 中

💡 关键看点:
• MA5/MA10/MA20 缠绕，短期方向不明
• 量比0.8，换手率1.2%，交投清淡
• 新闻面整体偏中性，需关注业绩预告
```

**字段数量：5个**
- analysis_summary（核心结论）
- trend_prediction（趋势预测）
- operation_advice（操作建议）
- confidence_level（置信度）
- key_points（关键看点）

---

### 📊 完整报告（11个字段）

点击任务卡片展开后显示：

```
📌 中国中免(601888) - 短期震荡调整，中长期仍具备配置价值

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📈 技术面分析:
MA5/MA10/MA20 均线系统呈现缠绕状态，短期方向不明。
MA5(85.2) < MA10(86.5) < MA20(87.1)，呈现空头排列。
量比0.8，换手率1.2%，今日交投清淡，观望情绪浓厚。
MACD(0.05)处于零轴附近，KDJ(45,50,55)中性区域。

💼 基本面分析:
公司作为免税行业龙头，受益于消费复苏趋势。
近期无重大财报披露，需关注年报预告时间。
行业竞争加剧，毛利率承压，但龙头地位稳固。

📰 消息面:
近期公司公告减持计划，短期股价承压。
行业政策利好预期增强，有望迎来政策窗口期。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📰 新闻详情:
  [⚠️ 风险排查] 控股股东减持5%股份  [🔴负面]
  评分: -0.72
  公司公告控股股东减持5%股份，减持价格区间为85-90元/股...
  上海证券报 | 2025-01-15

  [📰 最新消息] 中国中免发布业绩预告  [🟢正面]
  评分: +0.65
  公司发布2024年度业绩预告，预计净利润同比增长50%-60%...
  东方财富 | 2025-01-14

  [📈 机构分析] 中金公司维持"跑赢行业"评级  [🟢正面]
  评分: +0.58
  中金公司发布研报，维持中国中免"跑赢行业"评级，目标价100元...
  中金在线 | 2025-01-13

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 操作建议: 观望

⚠️ 风险提示:
短期面临控股股东减持压力，技术面偏弱，建议观望为主。
如跌破83元支撑位，需注意止损风险。
```

**字段数量：11个**
- analysis_summary（核心结论）
- technical_analysis（技术面详细分析）✨ 新增
- fundamental_analysis（基本面详细分析）✨ 新增
- news_summary（消息面摘要）✨ 新增
- news_list（新闻详情列表）✨ 新增
- operation_advice（操作建议）
- risk_warning（风险提示）✨ 新增

---

## 数据对比表

| 字段 | 精简报告 | 完整报告 | 说明 |
|------|---------|---------|------|
| analysis_summary | ✅ 显示 | ✅ 显示 | AI生成的核心结论（完全相同） |
| sentiment_score | ❌ 不显示 | ❌ 不显示 | 情绪评分（后台计算） |
| trend_prediction | ✅ 显示 | ❌ 不显示 | 趋势判断（震荡/看多/看空） |
| operation_advice | ✅ 显示 | ✅ 显示 | 操作建议（完全相同） |
| confidence_level | ✅ 显示 | ❌ 不显示 | 置信度（高/中/低） |
| key_points | ✅ 显示 | ❌ 不显示 | 关键看点（3-5个要点） |
| technical_analysis | ❌ 不显示 | ✅ 显示 | **技术面详细分析** |
| fundamental_analysis | ❌ 不显示 | ✅ 显示 | **基本面详细分析** |
| news_summary | ❌ 不显示 | ✅ 显示 | **消息面摘要** |
| news_list | ❌ 不显示 | ✅ 显示 | **新闻详情列表（含情绪评分）** |
| risk_warning | ❌ 不显示 | ✅ 显示 | **风险提示** |

---

## 代码实现差异

### 1. WebUI 显示逻辑

```javascript
// 精简报告
if (reportType === 'simple') {
    detailHtml += '<div>📌 ' + result.analysis_summary + '</div>';
    detailHtml += '<div>📊 趋势: ' + result.trend_prediction + '</div>';
    detailHtml += '<div>🎯 建议: ' + result.operation_advice + '</div>';
    detailHtml += '<div>📈 置信度: ' + result.confidence_level + '</div>';
    detailHtml += '<div>💡 关键看点: ' + result.key_points + '</div>';
}
// 完整报告
else if (reportType === 'full') {
    detailHtml += '<div>📈 技术面: ' + result.technical_analysis + '</div>';
    detailHtml += '<div>💼 基本面: ' + result.fundamental_analysis + '</div>';
    detailHtml += '<div>📰 消息面: ' + result.news_summary + '</div>';
    // 显示新闻列表（含情绪评分）
    for (const news of result.news_list) {
        detailHtml += '<div>' + news.title + ' [' + news.sentiment_label + ']</div>';
    }
    detailHtml += '<div>🎯 操作建议: ' + result.operation_advice + '</div>';
    detailHtml += '<div>⚠️ 风险提示: ' + result.risk_warning + '</div>';
}
```

### 2. 分析逻辑（完全相同）

```python
# pipeline.py - 分析过程完全相同
def analyze_stock(self, code: str):
    # Step 1: 获取实时行情
    # Step 2: 获取筹码分布
    # Step 3: 趋势分析
    # Step 4: 新闻搜索 + 情绪分析
    # Step 5: AI 分析
    result = self.analyzer.analyze(context, news_context, news_list)
    return result  # 无论 simple 还是 full，result 完全相同
```

---

## 适用场景

### 📝 精简报告 - 适合：

1. **快速浏览** - 想要快速获取核心结论
2. **移动端查看** - 信息量适中，阅读轻松
3. **已关注标的** - 对该标的已有了解，只需最新观点
4. **批量分析** - 查看多只股票时提高效率

### 📊 完整报告 - 适合：

1. **首次分析** - 第一次接触该标的，需要全面了解
2. **深度研究** - 需要技术面、基本面、消息面的详细分析
3. **重要决策** - 大额资金配置前，需要充分信息
4. **新闻跟踪** - 查看具体新闻内容和情绪评分

---

## 常见问题

### Q1: 精简报告和完整报告的分析结果会不同吗？

**A: 不会！**

两种报告使用**完全相同的数据**和**完全相同的 AI 分析过程**。

- 相同的技术面数据（MA、量比、换手率等）
- 相同的搜索新闻（多维度搜索）
- 相同的语义分析（FinBERT-Chinese 情绪评分）
- 相同的 AI 模型（temperature=0.0，确保输出确定性）

**唯一区别**：完整报告显示更多字段，精简报告只显示核心字段。

### Q2: 为什么有时候简洁版和详细版结果不一样？

**A: 这种情况不应该发生！**

如果在几分钟内分别请求简洁版和详细版，结果应该完全相同。

如果出现差异，可能原因：
1. **缓存过期**（超过5分钟），市场数据或新闻发生变化
2. **新的新闻发布**，导致分析结果改变
3. **AI 输出随机**（temperature > 0），但本项目已设置为 0.0

### Q3: 精简报告的"技术面数据"去哪了？

**A: 精简报告不显示技术面详细分析，但结论中已包含技术面因素。**

精简报告的 `analysis_summary` 和 `key_points` 已经综合了：
- 技术面（MA、量能）
- 基本面（行业地位）
- 消息面（新闻情绪）

只是不展开显示详细分析内容。

### Q4: 完整报告会消耗更多 API 配额吗？

**A: 不会！**

两种报告：
- 调用相同的 API（AkShare、Tavily、Gemini 等）
- 获取相同的数据量
- 生成相同的分析结果

区别仅在于前端显示的字段数量不同。

---

## 总结

| 项目 | 精简报告 | 完整报告 |
|------|---------|---------|
| **分析逻辑** | 完全相同 | 完全相同 |
| **数据来源** | 完全相同 | 完全相同 |
| **AI 分析** | 完全相同 | 完全相同 |
| **分析结果** | 完全相同 | 完全相同 |
| **显示字段** | 5个 | 11个 |
| **适用场景** | 快速浏览 | 深度研究 |

**记住：选择报告类型只是选择"看多少信息"，不是选择"如何分析"！**
